(()=>{var O=63710088e-1,ur={centimeters:O*100,centimetres:O*100,degrees:360/(2*Math.PI),feet:O*3.28084,inches:O*39.37,kilometers:O/1e3,kilometres:O/1e3,meters:O,metres:O,miles:O/1609.344,millimeters:O*1e3,millimetres:O*1e3,nauticalmiles:O/1852,radians:1,yards:O*1.0936};function lr(e,r,t={}){let n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function ue(e,r,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ee(e[0])||!Ee(e[1]))throw new Error("coordinates must contain numbers");return lr({type:"Point",coordinates:e},r,t)}function Me(e,r="kilometers"){let t=ur[r];if(!t)throw new Error(r+" units is invalid");return e*t}function _e(e){return e%(2*Math.PI)*180/Math.PI}function B(e){return e%360*Math.PI/180}function Ee(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function U(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ae(e){return e.type==="Feature"?e.geometry:e}function te(e,r,t={}){if(t.final===!0)return fr(e,r);let n=U(e),o=U(r),i=B(n[0]),l=B(o[0]),u=B(n[1]),f=B(o[1]),a=Math.sin(l-i)*Math.cos(f),m=Math.cos(u)*Math.sin(f)-Math.sin(u)*Math.cos(f)*Math.cos(l-i);return _e(Math.atan2(a,m))}function fr(e,r){let t=te(r,e);return t=(t+180)%360,t}var M=11102230246251565e-32,_=134217729,z=(3+8*M)*M;function K(e,r,t,n,o){let i,l,u,f,a=r[0],m=n[0],s=0,h=0;m>a==m>-a?(i=a,a=r[++s]):(i=m,m=n[++h]);let g=0;if(s<e&&h<t)for(m>a==m>-a?(l=a+i,u=i-(l-a),a=r[++s]):(l=m+i,u=i-(l-m),m=n[++h]),i=l,u!==0&&(o[g++]=u);s<e&&h<t;)m>a==m>-a?(l=i+a,f=l-i,u=i-(l-f)+(a-f),a=r[++s]):(l=i+m,f=l-i,u=i-(l-f)+(m-f),m=n[++h]),i=l,u!==0&&(o[g++]=u);for(;s<e;)l=i+a,f=l-i,u=i-(l-f)+(a-f),a=r[++s],i=l,u!==0&&(o[g++]=u);for(;h<t;)l=i+m,f=l-i,u=i-(l-f)+(m-f),m=n[++h],i=l,u!==0&&(o[g++]=u);return(i!==0||g===0)&&(o[g++]=i),g}function j(e,r){let t=r[0];for(let n=1;n<e;n++)t+=r[n];return t}function c(e){return new Float64Array(e)}var cr=(3+16*M)*M,mr=(2+12*M)*M,hr=(9+64*M)*M*M,Z=c(4),Fe=c(8),Se=c(12),Le=c(16),C=c(4);function gr(e,r,t,n,o,i,l){let u,f,a,m,s,h,g,d,y,w,p,b,v,P,E,A,L,F,q=e-o,S=t-o,D=r-i,I=n-i;P=q*I,h=_*q,g=h-(h-q),d=q-g,h=_*I,y=h-(h-I),w=I-y,E=d*w-(P-g*y-d*y-g*w),A=D*S,h=_*D,g=h-(h-D),d=D-g,h=_*S,y=h-(h-S),w=S-y,L=d*w-(A-g*y-d*y-g*w),p=E-L,s=E-p,Z[0]=E-(p+s)+(s-L),b=P+p,s=b-P,v=P-(b-s)+(p-s),p=v-A,s=v-p,Z[1]=v-(p+s)+(s-A),F=b+p,s=F-b,Z[2]=b-(F-s)+(p-s),Z[3]=F;let J=j(4,Z),x=mr*l;if(J>=x||-J>=x||(s=e-q,u=e-(q+s)+(s-o),s=t-S,a=t-(S+s)+(s-o),s=r-D,f=r-(D+s)+(s-i),s=n-I,m=n-(I+s)+(s-i),u===0&&f===0&&a===0&&m===0)||(x=hr*l+z*Math.abs(J),J+=q*m+I*u-(D*a+S*f),J>=x||-J>=x))return J;P=u*I,h=_*u,g=h-(h-u),d=u-g,h=_*I,y=h-(h-I),w=I-y,E=d*w-(P-g*y-d*y-g*w),A=f*S,h=_*f,g=h-(h-f),d=f-g,h=_*S,y=h-(h-S),w=S-y,L=d*w-(A-g*y-d*y-g*w),p=E-L,s=E-p,C[0]=E-(p+s)+(s-L),b=P+p,s=b-P,v=P-(b-s)+(p-s),p=v-A,s=v-p,C[1]=v-(p+s)+(s-A),F=b+p,s=F-b,C[2]=b-(F-s)+(p-s),C[3]=F;let ir=K(4,Z,4,C,Fe);P=q*m,h=_*q,g=h-(h-q),d=q-g,h=_*m,y=h-(h-m),w=m-y,E=d*w-(P-g*y-d*y-g*w),A=D*a,h=_*D,g=h-(h-D),d=D-g,h=_*a,y=h-(h-a),w=a-y,L=d*w-(A-g*y-d*y-g*w),p=E-L,s=E-p,C[0]=E-(p+s)+(s-L),b=P+p,s=b-P,v=P-(b-s)+(p-s),p=v-A,s=v-p,C[1]=v-(p+s)+(s-A),F=b+p,s=F-b,C[2]=b-(F-s)+(p-s),C[3]=F;let sr=K(ir,Fe,4,C,Se);P=u*m,h=_*u,g=h-(h-u),d=u-g,h=_*m,y=h-(h-m),w=m-y,E=d*w-(P-g*y-d*y-g*w),A=f*a,h=_*f,g=h-(h-f),d=f-g,h=_*a,y=h-(h-a),w=a-y,L=d*w-(A-g*y-d*y-g*w),p=E-L,s=E-p,C[0]=E-(p+s)+(s-L),b=P+p,s=b-P,v=P-(b-s)+(p-s),p=v-A,s=v-p,C[1]=v-(p+s)+(s-A),F=b+p,s=F-b,C[2]=b-(F-s)+(p-s),C[3]=F;let ar=K(sr,Se,4,C,Le);return Le[ar-1]}function le(e,r,t,n,o,i){let l=(r-i)*(t-o),u=(e-o)*(n-i),f=l-u,a=Math.abs(l+u);return Math.abs(f)>=cr*a?f:-gr(e,r,t,n,o,i,a)}var zr=(7+56*M)*M,jr=(3+28*M)*M,et=(26+288*M)*M*M,rt=c(4),tt=c(4),nt=c(4),ot=c(4),it=c(4),st=c(4),at=c(4),ut=c(4),lt=c(4),ft=c(8),ct=c(8),mt=c(8),ht=c(4),gt=c(8),pt=c(8),yt=c(8),dt=c(12),wt=c(192),bt=c(192);var Et=(10+96*M)*M,Mt=(4+48*M)*M,_t=(44+576*M)*M*M,At=c(4),Ft=c(4),St=c(4),Lt=c(4),Ct=c(4),kt=c(4),qt=c(4),Ot=c(4),Gt=c(8),Tt=c(8),Rt=c(8),Nt=c(8),Dt=c(8),It=c(8),Bt=c(8),Jt=c(8),Ut=c(8),Qt=c(4),Vt=c(4),Wt=c(4),Ht=c(8),$t=c(16),Kt=c(16),Xt=c(16),Yt=c(32),Zt=c(32),xt=c(48),zt=c(64),jt=c(1152),en=c(1152);var on=(16+224*M)*M,sn=(5+72*M)*M,an=(71+1408*M)*M*M,un=c(4),ln=c(4),fn=c(4),cn=c(4),mn=c(4),hn=c(4),gn=c(4),pn=c(4),yn=c(4),dn=c(4),wn=c(24),bn=c(24),vn=c(24),Pn=c(24),En=c(24),Mn=c(24),_n=c(24),An=c(24),Fn=c(24),Sn=c(24),Ln=c(1152),Cn=c(1152),kn=c(1152),qn=c(1152),On=c(1152),Gn=c(2304),Tn=c(2304),Rn=c(3456),Nn=c(5760),Dn=c(8),In=c(8),Bn=c(8),Jn=c(16),Un=c(24),Qn=c(48),Vn=c(48),Wn=c(96),Hn=c(192),$n=c(384),Kn=c(384),Xn=c(384),Yn=c(768);var Zn=c(96),xn=c(96),zn=c(96),jn=c(1152);function ne(e,r){var t,n,o=0,i,l,u,f,a,m,s,h=e[0],g=e[1],d=r.length;for(t=0;t<d;t++){n=0;var y=r[t],w=y.length-1;if(m=y[0],m[0]!==y[w][0]&&m[1]!==y[w][1])throw new Error("First and last coordinates in a ring must be the same");for(l=m[0]-h,u=m[1]-g,n;n<w;n++){if(s=y[n+1],f=s[0]-h,a=s[1]-g,u===0&&a===0){if(f<=0&&l>=0||l<=0&&f>=0)return 0}else if(a>=0&&u<=0||a<=0&&u>=0){if(i=le(l,f,u,a,0,0),i===0)return 0;(i>0&&a>0&&u<=0||i<0&&a<=0&&u>0)&&o++}m=s,u=a,l=f}}return o%2!==0}function fe(e,r,t={}){if(!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");let n=U(e),o=Ae(r),i=o.type,l=r.bbox,u=o.coordinates;if(l&&yr(n,l)===!1)return!1;i==="Polygon"&&(u=[u]);let f=!1;for(var a=0;a<u.length;++a){let m=ne(n,u[a]);if(m===0)return!t.ignoreBoundary;m&&(f=!0)}return f}function yr(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}var G=63710088e-1,bo={centimeters:G*100,centimetres:G*100,degrees:360/(2*Math.PI),feet:G*3.28084,inches:G*39.37,kilometers:G/1e3,kilometres:G/1e3,meters:G,metres:G,miles:G/1609.344,millimeters:G*1e3,millimetres:G*1e3,nauticalmiles:G/1852,radians:1,yards:G*1.0936};function ke(e,r,t={}){let n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function qe(e,r,t={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return ke({type:"LineString",coordinates:e},r,t)}function Oe(e,r={}){let t={type:"FeatureCollection"};return r.id&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.features=e,t}function Ge(e,r,t={}){return ke({type:"MultiLineString",coordinates:e},r,t)}function oe(e){return e.type==="Feature"?e.geometry:e}function Te(e,r={}){let t=oe(e);switch(!r.properties&&e.type==="Feature"&&(r.properties=e.properties),t.type){case"Polygon":return dr(t,r);case"MultiPolygon":return wr(t,r);default:throw new Error("invalid poly")}}function dr(e,r={}){let n=oe(e).coordinates,o=r.properties?r.properties:e.type==="Feature"?e.properties:{};return Re(n,o)}function wr(e,r={}){let n=oe(e).coordinates,o=r.properties?r.properties:e.type==="Feature"?e.properties:{},i=[];return n.forEach(l=>{i.push(Re(l,o))}),Oe(i)}function Re(e,r){return e.length>1?Ge(e,r):qe(e[0],r)}var T=63710088e-1,Ao={centimeters:T*100,centimetres:T*100,degrees:360/(2*Math.PI),feet:T*3.28084,inches:T*39.37,kilometers:T/1e3,kilometres:T/1e3,meters:T,metres:T,miles:T/1609.344,millimeters:T*1e3,millimetres:T*1e3,nauticalmiles:T/1852,radians:1,yards:T*1.0936};function br(e,r,t={}){let n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function De(e,r,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ne(e[0])||!Ne(e[1]))throw new Error("coordinates must contain numbers");return br({type:"Point",coordinates:e},r,t)}function Ne(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ce(e,r,t){if(e!==null)for(var n,o,i,l,u,f,a,m=0,s=0,h,g=e.type,d=g==="FeatureCollection",y=g==="Feature",w=d?e.features.length:1,p=0;p<w;p++){a=d?e.features[p].geometry:y?e.geometry:e,h=a?a.type==="GeometryCollection":!1,u=h?a.geometries.length:1;for(var b=0;b<u;b++){var v=0,P=0;if(l=h?a.geometries[b]:a,l!==null){f=l.coordinates;var E=l.type;switch(m=t&&(E==="Polygon"||E==="MultiPolygon")?1:0,E){case null:break;case"Point":if(r(f,s,p,v,P)===!1)return!1;s++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<f.length;n++){if(r(f[n],s,p,v,P)===!1)return!1;s++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<f.length;n++){for(o=0;o<f[n].length-m;o++){if(r(f[n][o],s,p,v,P)===!1)return!1;s++}E==="MultiLineString"&&v++,E==="Polygon"&&P++}E==="Polygon"&&v++;break;case"MultiPolygon":for(n=0;n<f.length;n++){for(P=0,o=0;o<f[n].length;o++){for(i=0;i<f[n][o].length-m;i++){if(r(f[n][o][i],s,p,v,P)===!1)return!1;s++}P++}v++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(ce(l.geometries[n],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ie(e,r={}){if(e.bbox!=null&&r.recompute!==!0)return e.bbox;let t=[1/0,1/0,-1/0,-1/0];return ce(e,n=>{t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}function me(e,r={}){let t=Ie(e),n=(t[0]+t[2])/2,o=(t[1]+t[3])/2;return De([n,o],r.properties,r)}function he(e,r,t={}){var n=U(e),o=U(r),i=B(o[1]-n[1]),l=B(o[0]-n[0]),u=B(n[1]),f=B(o[1]),a=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(f);return Me(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),t.units)}var k=63710088e-1,Be={centimeters:k*100,centimetres:k*100,degrees:360/(2*Math.PI),feet:k*3.28084,inches:k*39.37,kilometers:k/1e3,kilometres:k/1e3,meters:k,metres:k,miles:k/1609.344,millimeters:k*1e3,millimetres:k*1e3,nauticalmiles:k/1852,radians:1,yards:k*1.0936};function vr(e,r="kilometers"){let t=Be[r];if(!t)throw new Error(r+" units is invalid");return e*t}function Pr(e,r="kilometers"){let t=Be[r];if(!t)throw new Error(r+" units is invalid");return e/t}function Je(e,r="kilometers",t="kilometers"){if(!(e>=0))throw new Error("length must be a positive number");return vr(Pr(e,r),t)}function ge(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ie(e,r,t={}){let n=ge(e),o=ge(r);o[0]+=o[0]-n[0]>180?-360:n[0]-o[0]>180?360:0;let i=Er(n,o);return Je(i,"meters",t.units)}function Er(e,r,t){t=t===void 0?k:Number(t);let n=t,o=e[1]*Math.PI/180,i=r[1]*Math.PI/180,l=i-o,u=Math.abs(r[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);let f=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),a=Math.abs(f)>1e-11?l/f:Math.cos(o);return Math.sqrt(l*l+a*a*u*u)*n}var R=63710088e-1,Qe={centimeters:R*100,centimetres:R*100,degrees:360/(2*Math.PI),feet:R*3.28084,inches:R*39.37,kilometers:R/1e3,kilometres:R/1e3,meters:R,metres:R,miles:R/1609.344,millimeters:R*1e3,millimetres:R*1e3,nauticalmiles:R/1852,radians:1,yards:R*1.0936};function Q(e,r,t={}){let n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function V(e,r,t={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ue(e[0])||!Ue(e[1]))throw new Error("coordinates must contain numbers");return Q({type:"Point",coordinates:e},r,t)}function ee(e,r,t={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return Q({type:"LineString",coordinates:e},r,t)}function pe(e,r="kilometers"){let t=Qe[r];if(!t)throw new Error(r+" units is invalid");return e*t}function Mr(e,r="kilometers"){let t=Qe[r];if(!t)throw new Error(r+" units is invalid");return e/t}function ye(e){return e%(2*Math.PI)*180/Math.PI}function W(e){return e%360*Math.PI/180}function Ve(e,r="kilometers",t="kilometers"){if(!(e>=0))throw new Error("length must be a positive number");return pe(Mr(e,r),t)}function Ue(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function H(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function We(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function de(e,r,t){if(!e)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!e.geometry||e.geometry.type!==r)throw new Error("Invalid input to "+t+": must be a "+r+", given "+e.geometry.type)}function $(e,r,t={}){var n=H(e),o=H(r),i=W(o[1]-n[1]),l=W(o[0]-n[0]),u=W(n[1]),f=W(o[1]),a=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(u)*Math.cos(f);return pe(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),t.units)}function He(e,r,t){if(e!==null)for(var n,o,i,l,u,f,a,m=0,s=0,h,g=e.type,d=g==="FeatureCollection",y=g==="Feature",w=d?e.features.length:1,p=0;p<w;p++){a=d?e.features[p].geometry:y?e.geometry:e,h=a?a.type==="GeometryCollection":!1,u=h?a.geometries.length:1;for(var b=0;b<u;b++){var v=0,P=0;if(l=h?a.geometries[b]:a,l!==null){f=l.coordinates;var E=l.type;switch(m=t&&(E==="Polygon"||E==="MultiPolygon")?1:0,E){case null:break;case"Point":if(r(f,s,p,v,P)===!1)return!1;s++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<f.length;n++){if(r(f[n],s,p,v,P)===!1)return!1;s++,E==="MultiPoint"&&v++}E==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<f.length;n++){for(o=0;o<f[n].length-m;o++){if(r(f[n][o],s,p,v,P)===!1)return!1;s++}E==="MultiLineString"&&v++,E==="Polygon"&&P++}E==="Polygon"&&v++;break;case"MultiPolygon":for(n=0;n<f.length;n++){for(P=0,o=0;o<f[n].length;o++){for(i=0;i<f[n][o].length-m;i++){if(r(f[n][o][i],s,p,v,P)===!1)return!1;s++}P++}v++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(He(l.geometries[n],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function _r(e,r){var t,n,o,i,l,u,f,a,m,s,h=0,g=e.type==="FeatureCollection",d=e.type==="Feature",y=g?e.features.length:1;for(t=0;t<y;t++){for(u=g?e.features[t].geometry:d?e.geometry:e,a=g?e.features[t].properties:d?e.properties:{},m=g?e.features[t].bbox:d?e.bbox:void 0,s=g?e.features[t].id:d?e.id:void 0,f=u?u.type==="GeometryCollection":!1,l=f?u.geometries.length:1,o=0;o<l;o++){if(i=f?u.geometries[o]:u,i===null){if(r(null,h,a,m,s)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(i,h,a,m,s)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<i.geometries.length;n++)if(r(i.geometries[n],h,a,m,s)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}h++}}function we(e,r){_r(e,function(t,n,o,i,l){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return r(Q(t,o,{bbox:i,id:l}),n,0)===!1?!1:void 0}var f;switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var a=0;a<t.coordinates.length;a++){var m=t.coordinates[a],s={type:f,coordinates:m};if(r(Q(s,o),n,a)===!1)return!1}})}function $e(e,r){we(e,function(t,n,o){var i=0;if(t.geometry){var l=t.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var u,f=0,a=0,m=0;if(He(t,function(s,h,g,d,y){if(u===void 0||n>f||d>a||y>m){u=s,f=n,a=d,m=y,i=0;return}var w=ee([u,s],t.properties);if(r(w,n,o,y,i)===!1)return!1;i++,u=s})===!1)return!1}}})}var Ar=Object.defineProperty,Fr=Object.defineProperties,Sr=Object.getOwnPropertyDescriptors,Ke=Object.getOwnPropertySymbols,Lr=Object.prototype.hasOwnProperty,Cr=Object.prototype.propertyIsEnumerable,Xe=(e,r,t)=>r in e?Ar(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Ye=(e,r)=>{for(var t in r||(r={}))Lr.call(r,t)&&Xe(e,t,r[t]);if(Ke)for(var t of Ke(r))Cr.call(r,t)&&Xe(e,t,r[t]);return e},Ze=(e,r)=>Fr(e,Sr(r));function ze(e,r,t={}){if(!e||!r)throw new Error("lines and pt are required arguments");let n=H(r),o=V([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),i=0;return we(e,function(l,u,f){let a=We(l);for(let m=0;m<a.length-1;m++){let s=V(a[m]);s.properties.dist=$(r,s,t);let h=H(s),g=V(a[m+1]);g.properties.dist=$(r,g,t);let d=H(g),y=$(s,g,t),w,p;h[0]===n[0]&&h[1]===n[1]?[w,,p]=[h,void 0,!1]:d[0]===n[0]&&d[1]===n[1]?[w,,p]=[d,void 0,!0]:[w,,p]=Or(s.geometry.coordinates,g.geometry.coordinates,H(r));let b;w&&(b=V(w,{dist:$(r,w,t),multiFeatureIndex:f,location:i+$(s,w,t)})),b&&b.properties.dist<o.properties.dist&&(o=Ze(Ye({},b),{properties:Ze(Ye({},b.properties),{index:p?m+1:m})})),i+=y}}),o}function kr(e,r){let[t,n,o]=e,[i,l,u]=r;return t*i+n*l+o*u}function qr(e,r){let[t,n,o]=e,[i,l,u]=r;return[n*u-o*l,o*i-t*u,t*l-n*i]}function xe(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2))}function X(e,r){let t=kr(e,r)/(xe(e)*xe(r));return Math.acos(Math.min(Math.max(t,-1),1))}function be(e){let r=W(e[1]),t=W(e[0]);return[Math.cos(r)*Math.cos(t),Math.cos(r)*Math.sin(t),Math.sin(r)]}function Y(e){let[r,t,n]=e,o=ye(Math.asin(n));return[ye(Math.atan2(t,r)),o]}function Or(e,r,t){let n=be(e),o=be(r),i=be(t),[l,u,f]=i,[a,m,s]=qr(n,o),h=m*f-s*u,g=s*l-a*f,d=a*u-m*l,y=d*m-g*s,w=h*s-d*a,p=g*a-h*m,b=1/Math.sqrt(Math.pow(y,2)+Math.pow(w,2)+Math.pow(p,2)),v=[y*b,w*b,p*b],P=[-1*y*b,-1*w*b,-1*p*b],E=X(n,o),A=X(n,v),L=X(o,v),F=X(n,P),q=X(o,P),S;return A<F&&A<q||L<F&&L<q?S=v:S=P,X(n,S)>E||X(o,S)>E?$(Y(S),Y(n))<=$(Y(S),Y(o))?[Y(n),!0,!1]:[Y(o),!1,!0]:[Y(S),!1,!1]}function er(e,r,t={}){var n,o;let i=(n=t.method)!=null?n:"geodesic",l=(o=t.units)!=null?o:"kilometers";if(!e)throw new Error("pt is required");if(Array.isArray(e)?e=V(e):e.type==="Point"?e=Q(e):de(e,"Point","point"),!r)throw new Error("line is required");Array.isArray(r)?r=ee(r):r.type==="LineString"?r=Q(r):de(r,"LineString","line");let u=1/0,f=e.geometry.coordinates;return $e(r,a=>{if(a){let m=a.geometry.coordinates[0],s=a.geometry.coordinates[1],h=Gr(f,m,s,{method:i});h<u&&(u=h)}}),Ve(u,"degrees",l)}function Gr(e,r,t,n){if(n.method==="geodesic")return ze(ee([r,t]).geometry,e,{units:"degrees"}).properties.dist;let o=[t[0]-r[0],t[1]-r[1]],i=[e[0]-r[0],e[1]-r[1]],l=je(i,o);if(l<=0)return ie(e,r,{units:"degrees"});let u=je(o,o);if(u<=l)return ie(e,t,{units:"degrees"});let f=l/u,a=[r[0]+f*o[0],r[1]+f*o[1]];return ie(e,a,{units:"degrees"})}function je(e,r){return e[0]*r[0]+e[1]*r[1]}var N=63710088e-1,si={centimeters:N*100,centimetres:N*100,degrees:360/(2*Math.PI),feet:N*3.28084,inches:N*39.37,kilometers:N/1e3,kilometres:N/1e3,meters:N,metres:N,miles:N/1609.344,millimeters:N*1e3,millimetres:N*1e3,nauticalmiles:N/1852,radians:1,yards:N*1.0936};function se(e,r,t={}){let n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function ve(e,r,t={}){for(let o of e){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let i=0;i<o[o.length-1].length;i++)if(o[o.length-1][i]!==o[0][i])throw new Error("First and last Position are not equivalent.")}return se({type:"Polygon",coordinates:e},r,t)}function rr(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ae(e){return e.type==="Feature"?e.geometry:e}function Pe(e,r,t={}){if(!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");let n=rr(e),o=ae(r),i=o.type,l=r.bbox,u=o.coordinates;if(l&&Tr(n,l)===!1)return!1;i==="Polygon"&&(u=[u]);let f=!1;for(var a=0;a<u.length;++a){let m=ne(n,u[a]);if(m===0)return!t.ignoreBoundary;m&&(f=!0)}return f}function Tr(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}function Rr(e,r){var t,n,o,i,l,u,f,a,m,s,h=0,g=e.type==="FeatureCollection",d=e.type==="Feature",y=g?e.features.length:1;for(t=0;t<y;t++){for(u=g?e.features[t].geometry:d?e.geometry:e,a=g?e.features[t].properties:d?e.properties:{},m=g?e.features[t].bbox:d?e.bbox:void 0,s=g?e.features[t].id:d?e.id:void 0,f=u?u.type==="GeometryCollection":!1,l=f?u.geometries.length:1,o=0;o<l;o++){if(i=f?u.geometries[o]:u,i===null){if(r(null,h,a,m,s)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(i,h,a,m,s)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<i.geometries.length;n++)if(r(i.geometries[n],h,a,m,s)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}h++}}function tr(e,r){Rr(e,function(t,n,o,i,l){var u=t===null?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return r(se(t,o,{bbox:i,id:l}),n,0)===!1?!1:void 0}var f;switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var a=0;a<t.coordinates.length;a++){var m=t.coordinates[a],s={type:f,coordinates:m};if(r(se(s,o),n,a)===!1)return!1}})}function re(e,r,t={}){var n,o;let i=(n=t.method)!=null?n:"geodesic",l=(o=t.units)!=null?o:"kilometers";if(!e)throw new Error("point is required");if(!r)throw new Error("polygon or multi-polygon is required");let u=ae(r);if(u.type==="MultiPolygon"){let m=u.coordinates.map(s=>re(e,ve(s),{method:i,units:l}));return Math.min(...m.map(Math.abs))*(Pe(e,r)?-1:1)}if(u.coordinates.length>1){let[m,...s]=u.coordinates.map(g=>re(e,ve([g]),{method:i,units:l}));if(m>=0)return m;let h=Math.min(...s);return h<0?Math.abs(h):Math.min(h,Math.abs(m))}let f=Te(u),a=1/0;return tr(f,m=>{a=Math.min(a,er(e,m,{method:i,units:l}))}),Pe(e,u)?-a:a}var Dr=async()=>{let e=[{url:"./data/bl25/neighbourhoods.geojson",name:"neighborhoods"},{url:"./data/bl25/Plazas_BL25_export.geojson",name:"plazas"},{url:"./data/bl25/poi/customPOIforJOMO.geojson",name:"POIs"}],r=await Promise.all(e.map(n=>Ir(n.url))),t={};return e.forEach((n,o)=>{t[n.name]=r[o]}),t},Ir=async e=>{try{return await(await fetch(e)).json()}catch(r){throw console.error("Error loading GeoJSON:",r),r}},Br=(e,r)=>e.features.find(t=>fe(r,t))?.properties.name||"",nr=(e,r)=>{let t=1/0,n="",o=null;for(let i of e.features){let l=1/0;i.geometry.type==="Point"?l=he(r,i,{units:"meters"}):(i.geometry.type==="Polygon"||i.geometry.type==="MultiPolygon")&&(l=re(r,i,{units:"meters"})),l<t&&(t=l,n=i.properties.name||"(No name)",o=i)}return t=t<0?0:Math.round(t),{areaName:n.replace(/\n/g," "),distance:t,areaFeature:o}},or=(e,r)=>{let n=me(e).geometry.coordinates,o=te(ue(n),r),i=["N","NE","E","SE","S","SW","W","NW","N"],l=Math.round((o%360+360)%360/45);return i[l]},Jr=()=>{let e=new URLSearchParams(window.location.search),r=e.get("coords")?e.get("coords").split(",").map(Number):[],t=[r[1],r[0]];return ue(t)},Ur=e=>{let r=document.getElementById("main"),t=document.createElement("table"),n=Object.keys(e);t.appendChild(Object.assign(document.createElement("tr"),{innerHTML:n.map(i=>`<th>${i}</th>`).join("")}));let o=Math.max(...n.map(i=>e[i]?.features?.length||0));for(let i=0;i<o;i++)t.appendChild(Object.assign(document.createElement("tr"),{innerHTML:n.map(l=>`<td>${e[l]?.features?.[i]?.properties?.name||""}</td>`).join("")}));r.appendChild(t)},Qr=async()=>{let e=await Dr(),r={neighborhood:document.getElementById("neighborhood"),closest_plaza:document.getElementById("closest_plaza"),distance_to_plaza:document.getElementById("distance_to_plaza"),direction_from_plaza:document.getElementById("direction_from_plaza"),closest_poi:document.getElementById("closest_poi"),distance_to_poi:document.getElementById("distance_to_poi"),direction_from_poi:document.getElementById("direction_from_poi")},t=Jr(),n=Br(e.neighborhoods,t);r.neighborhood.value=n;let o=nr(e.plazas,t);r.closest_plaza.value=o.areaName,r.distance_to_plaza.value=Math.round(o.distance),r.direction_from_plaza.value=or(o.areaFeature,t);let i=nr(e.POIs,t);r.closest_poi.value=i.areaName,r.distance_to_poi.value=Math.round(i.distance),r.direction_from_poi.value=or(i.areaFeature,t),Ur(e)};Qr();})();
